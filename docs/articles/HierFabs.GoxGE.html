<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="HierFabs">
<title>HierFabs: SKCM Data Analysis with Cox-GE model • HierFabs</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="HierFabs: SKCM Data Analysis with Cox-GE model">
<meta property="og:description" content="HierFabs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">HierFabs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/HierFabs.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/HierFabs.GGLM.html">HierFabs: SKCM Data Analysis with LM-GG model</a>
    <a class="dropdown-item" href="../articles/HierFabs.GoxGE.html">HierFabs: SKCM Data Analysis with Cox-GE model</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>HierFabs: SKCM Data Analysis with Cox-GE model</h1>
                        <h4 data-toc-skip class="author">Xiao Zhang</h4>
            
            <h4 data-toc-skip class="date">2022-10-21</h4>
      
      
      <div class="d-none name"><code>HierFabs.GoxGE.Rmd</code></div>
    </div>

    
    
<p>This vignette introduces the <code>HierFabs</code> workflow for the
analysis of the skin cutaneous melanoma (SKCM) dataset downloaded from
The Cancer Genome Atlas <a href="https://tcga-data.nci.nih.gov" class="external-link">TCGA</a>, which contains disease
outcomes, environmental factors, and high-dimensional gene expressions.
The goal of analysis is to identify interactions that are associated
with the prognosis of SKCM.</p>
<p>We demonstrate the use of <code>HierFabs</code> to the SKCM data that
are <a href="https://github.com/XiaoZhangryy/HierFabs/tree/master/vignettes_data">here</a>,
which can be downloaded to the current working path by the following
command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">githubURL</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/XiaoZhangryy/HierFabs/blob/master/vignettes_data/cleaned_menaloma_Data.rda?raw=true"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">githubURL</span>, <span class="st">"cleaned_menaloma_Data.rda"</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span></code></pre></div>
<p>The outcome of interest is overall survival. After removing samples
with missing survival time and genes with minimal expression variations,
we obtain 17,944 gene expressions on 253 patients. For gene expression
measurements, the top 2,000 are screened out for downstream analysis
(Jiang et al. 2016). Each gene expression is standardized to have mean
zero and standard deviation one.</p>
<p>The package can be loaded with the command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">HierFabs</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org/" class="external-link">Matrix</a></span><span class="op">)</span></span></code></pre></div>
<p>Then load datasets to R</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"cleaned_menaloma_Data.rda"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="fit-a-cox-model-with-gene-environment-interaction-under-weak-hierarchy-constraint-">Fit a Cox model with gene-environment interaction under weak
hierarchy constraint.<a class="anchor" aria-label="anchor" href="#fit-a-cox-model-with-gene-environment-interaction-under-weak-hierarchy-constraint-"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">status</span> <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">status</span></span>
<span><span class="va">E</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">E</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">G</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HierFabs.html">HierFabs</a></span><span class="op">(</span><span class="va">E</span>, <span class="va">y</span>, <span class="va">G</span>, model <span class="op">=</span> <span class="st">"cox"</span>, eps <span class="op">=</span> <span class="fl">0.01</span>, hier <span class="op">=</span> <span class="st">"weak"</span>, status <span class="op">=</span> <span class="va">status</span>, diagonal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    max_s <span class="op">=</span> <span class="fl">40</span>, criteria <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span></code></pre></div>
<p>Then, we can use the <code>print</code> function to show the
result.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5 x 20 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;                                                                           </span></span>
<span><span class="co">#&gt; main effect                    .       -0.00814  .        .        .      </span></span>
<span><span class="co">#&gt; tumor_status                   0.92192  .       -0.17667 -0.05527 -0.11836</span></span>
<span><span class="co">#&gt; breslow_thickness_at_diagnosis 0.00207  .        .        .        .      </span></span>
<span><span class="co">#&gt; age_at_diagnosis               0.00500  .        .        .        .      </span></span>
<span><span class="co">#&gt; new_tumor_event_dx_indicator   .       -0.03493  .        .        .      </span></span>
<span><span class="co">#&gt;                                                                           </span></span>
<span><span class="co">#&gt; main effect                     .        .        .        .        .     </span></span>
<span><span class="co">#&gt; tumor_status                   -0.01062 -0.05482 -0.01383 -0.10996 -0.0125</span></span>
<span><span class="co">#&gt; breslow_thickness_at_diagnosis  .        .        .        .        .     </span></span>
<span><span class="co">#&gt; age_at_diagnosis                .        .        .        .        .     </span></span>
<span><span class="co">#&gt; new_tumor_event_dx_indicator    .        .        .        .        .     </span></span>
<span><span class="co">#&gt;                                                                            </span></span>
<span><span class="co">#&gt; main effect                     .        .        .        .        .      </span></span>
<span><span class="co">#&gt; tumor_status                   -0.13057 -0.01511 -0.02738 -0.01543 -0.03612</span></span>
<span><span class="co">#&gt; breslow_thickness_at_diagnosis  .        .        .        .        .      </span></span>
<span><span class="co">#&gt; age_at_diagnosis                .        .        .        .        .      </span></span>
<span><span class="co">#&gt; new_tumor_event_dx_indicator    .        .        .        .        .      </span></span>
<span><span class="co">#&gt;                                                                          </span></span>
<span><span class="co">#&gt; main effect                     .        .        .        .       .     </span></span>
<span><span class="co">#&gt; tumor_status                   -0.01176 -0.01233  .        .       .     </span></span>
<span><span class="co">#&gt; breslow_thickness_at_diagnosis  .        .       -0.00461 -0.12921 .     </span></span>
<span><span class="co">#&gt; age_at_diagnosis                .        .        .        .        8e-04</span></span>
<span><span class="co">#&gt; new_tumor_event_dx_indicator    .        .        .        .       .</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.1.3 (2022-03-10)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Windows 10 x64 (build 19043)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=English_United States.1252 </span></span>
<span><span class="co">#&gt; [2] LC_CTYPE=English_United States.1252   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=English_United States.1252</span></span>
<span><span class="co">#&gt; [4] LC_NUMERIC=C                          </span></span>
<span><span class="co">#&gt; [5] LC_TIME=English_United States.1252    </span></span>
<span><span class="co">#&gt; system code page: 936</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] Matrix_1.5-1   HierFabs_0.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] rstudioapi_0.13   knitr_1.38        magrittr_2.0.3    lattice_0.20-45  </span></span>
<span><span class="co">#&gt;  [5] R6_2.5.1          ragg_1.2.2        rlang_1.0.6       fastmap_1.1.0    </span></span>
<span><span class="co">#&gt;  [9] stringr_1.4.1     tools_4.1.3       grid_4.1.3        xfun_0.30        </span></span>
<span><span class="co">#&gt; [13] cli_3.2.0         jquerylib_0.1.4   htmltools_0.5.3   systemfonts_1.0.4</span></span>
<span><span class="co">#&gt; [17] yaml_2.3.5        digest_0.6.29     rprojroot_2.0.3   pkgdown_2.0.6    </span></span>
<span><span class="co">#&gt; [21] textshaping_0.3.6 purrr_0.3.4       formatR_1.12      sass_0.4.2       </span></span>
<span><span class="co">#&gt; [25] fs_1.5.2          memoise_2.0.1     cachem_1.0.6      evaluate_0.15    </span></span>
<span><span class="co">#&gt; [29] rmarkdown_2.13    stringi_1.7.8     compiler_4.1.3    bslib_0.4.0      </span></span>
<span><span class="co">#&gt; [33] desc_1.4.1        jsonlite_1.8.2</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Xiao Zhang, Xu Liu, Yiming Liu, Xingjie Shi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
