<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Provides an efficient procedure for fitting the entire solution path adaptively for identifying hierachical interaction of genomics data in linear model or cox model under the strong or weak heredity constraint. Lasso penalty is used to generate a sparse solution. Both gene-gene type interactions and gene-environment interactions are supported. ">
<title>A General Framework for Identifying Hierachical Interaction of Genomics Data interaction of genomics data • HierFabs</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="A General Framework for Identifying Hierachical Interaction of Genomics Data interaction of genomics data">
<meta property="og:description" content="Provides an efficient procedure for fitting the entire solution path adaptively for identifying hierachical interaction of genomics data in linear model or cox model under the strong or weak heredity constraint. Lasso penalty is used to generate a sparse solution. Both gene-gene type interactions and gene-environment interactions are supported. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">HierFabs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/HierFabs.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/HierFabs.GGLM.html">HierFabs: SKCM Data Analysis with LM-GG model</a>
    <a class="dropdown-item" href="articles/HierFabs.GoxGE.html">HierFabs: SKCM Data Analysis with Cox-GE model</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="https://github.com/XiaoZhangryy/HierFabs/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="hierfabs">HierFabs<a class="anchor" aria-label="anchor" href="#hierfabs"></a>
</h1></div>
<p>A hierarchical Forward and Backward Stagewise (HierFabs) algorithm for identifying hierachical interaction of genomics data</p>
<p>HierFabs uses coordinate descent with a fixed step size which consists of both forward and backward steps. At each step, the first-order Taylor’s expansion is used to reflect the main part of the increment.</p>
<p>Check out our <a href="https://XiaoZhangryy.github.io/HierFabs/index.html" class="external-link">Package Website</a> for a more complete description of the methods and analyses.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install Rtools 3.5 (http://cran.r-project.org/bin/windows/Rtools)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("devtools")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("Rcpp")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"XiaoZhangryy/HierFabs"</span>)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h1>
<ul class="task-list">
<li>
<input type="checkbox" disabled checked><a href="https://github.com/XiaoZhangryy/HierFabs/blob/master/inst/HierFabs-manual.pdf">HierFabs-manual</a> ———— Details of the usage of the package.</li>
</ul>
</div>
<div class="section level1">
<h1 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HierFabs)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>p),n,p)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">=</span> x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%*%</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>) <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x[,<span class="dv">1</span>]<span class="sc">*</span>x[,<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x[,<span class="dv">1</span>]<span class="sc">*</span>x[,<span class="dv">4</span>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span>  eta <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>xtest <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>p),n,p)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>eta.test <span class="ot">=</span> xtest[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%*%</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>) <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>xtest[,<span class="dv">1</span>]<span class="sc">*</span>xtest[,<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>xtest[,<span class="dv">1</span>]<span class="sc">*</span>xtest[,<span class="dv">4</span>]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>ytest <span class="ot">=</span>  eta.test <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>fit.gg.strong <span class="ot">=</span> <span class="fu">HierFabs</span>(x, y)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>y.pred.gg.s <span class="ot">=</span> <span class="fu">predict</span>(fit.gg.strong, xtest, ytest)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>y.pred.gg.s<span class="sc">$</span>mse</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit.gg.strong)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Weak hierarchy</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>fit.gg.weak <span class="ot">=</span> <span class="fu">HierFabs</span>(x, y, <span class="at">hier=</span><span class="st">"weak"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>y.pred.gg.w <span class="ot">=</span> <span class="fu">predict</span>(fit.gg.weak, xtest, ytest)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>y.pred.gg.w<span class="sc">$</span>mse</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit.gg.weak)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Cox model with Gene-Environment interactions</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>pz <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>pz),n,pz)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>eta.ge <span class="ot">=</span> x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%*%</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>) <span class="sc">+</span> z[,<span class="dv">1</span>] <span class="sc">+</span> z[,<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x[,<span class="dv">1</span>]<span class="sc">*</span>z[,<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x[,<span class="dv">2</span>]<span class="sc">*</span>z[,<span class="dv">2</span>]</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>err <span class="ot">=</span> <span class="fu">log</span>(<span class="fu">rweibull</span>(n, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>eta.ge <span class="sc">+</span> err)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>cens <span class="ot">=</span> <span class="fu">quantile</span>(y0, <span class="fl">0.9</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>y.ge <span class="ot">=</span> <span class="fu">pmin</span>(y0, cens)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>status <span class="ot">=</span> <span class="dv">1</span> <span class="sc">*</span> (y0<span class="sc">&lt;=</span>cens)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>ztest <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>pz),n,pz)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>eta.ge.test <span class="ot">=</span> <span class="fu">rowSums</span>(xtest[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span> ztest[,<span class="dv">1</span>] <span class="sc">+</span> ztest[,<span class="dv">2</span>]</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>eta.ge.test <span class="ot">=</span> eta.ge.test <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>xtest[,<span class="dv">1</span>]<span class="sc">*</span>ztest[,<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>xtest[,<span class="dv">2</span>]<span class="sc">*</span>ztest[,<span class="dv">2</span>]</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>err.test <span class="ot">=</span> <span class="fu">log</span>(<span class="fu">rweibull</span>(n, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>))</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>y0.test <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>eta.ge.test <span class="sc">+</span> err.test)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>cens <span class="ot">=</span> <span class="fu">quantile</span>(y0.test, <span class="fl">0.9</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>y.ge.test <span class="ot">=</span> <span class="fu">pmin</span>(y0.test, cens)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>status.test <span class="ot">=</span> <span class="dv">1</span> <span class="sc">*</span> (y0.test<span class="sc">&lt;=</span>cens)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>fit.ge.strong <span class="ot">=</span> <span class="fu">HierFabs</span>(x, y.ge, z, <span class="at">model=</span><span class="st">"cox"</span>, <span class="at">status=</span>status)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>y.pred.ge.s <span class="ot">=</span> <span class="fu">predict</span>(fit.ge.strong, xtest, y.ge.test, ztest, status.test)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>y.pred.ge.s<span class="sc">$</span>c.index</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit.ge.strong)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="do">## Weak hierarchy</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>fit.ge.weak <span class="ot">=</span> <span class="fu">HierFabs</span>(x, y.ge, z, <span class="at">model=</span><span class="st">"cox"</span>, <span class="at">status=</span>status, <span class="at">hier=</span><span class="st">"weak"</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>y.pred.ge.w <span class="ot">=</span> <span class="fu">predict</span>(fit.ge.weak, xtest, y.ge.test, ztest, status.test)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>y.pred.ge.w<span class="sc">$</span>c.index</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit.ge.weak)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<p>A General Framework for Identifying Hierachical Interaction of Genomics Data. Manuscript.</p>
</div>
<div class="section level1">
<h1 id="development">Development<a class="anchor" aria-label="anchor" href="#development"></a>
</h1>
<p>The R-package is developed by Xiao Zhang (<a href="mailto:zhangxiao_0422@163.com" class="email">zhangxiao_0422@163.com</a>).</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/XiaoZhangryy/HierFabs/">Browse source code</a></li>
<li><a href="https://github.com/XiaoZhangryy/HierFabs/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing HierFabs</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Xiao Zhang <br><small class="roles"> Author, maintainer </small>  </li>
<li>Xu Liu <br><small class="roles"> Author </small>  </li>
<li>Yiming Liu <br><small class="roles"> Author </small>  </li>
<li>Xingjie Shi <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Xiao Zhang, Xu Liu, Yiming Liu, Xingjie Shi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
